2025-07-22 00:04:47,913 - gcsBot - INFO - Logger configurado para o modo: ''. Logs de console a partir do nível INFO.
2025-07-22 00:04:47,986 - gcsBot - INFO - --- MODO: OTIMIZAÇÃO WALK-FORWARD ---
2025-07-22 00:04:47,986 - gcsBot - INFO - Iniciando o processo de otimização para encontrar os melhores parâmetros...
2025-07-22 00:04:50,236 - gcsBot - INFO - Cliente Binance inicializado em modo REAL. Conexão com a API confirmada.
2025-07-22 00:04:50,237 - gcsBot - INFO - Iniciando processo de unificação de dados.
2025-07-22 00:04:50,237 - gcsBot - INFO - Iniciando verificação e atualização dos dados macro...
2025-07-22 00:04:50,246 - gcsBot - INFO - Table 'macro_dxy' created successfully.
2025-07-22 00:04:50,247 - gcsBot - INFO - Dados macro para 'dxy' já estão atualizados.
2025-07-22 00:04:50,249 - gcsBot - INFO - Table 'macro_gold' created successfully.
2025-07-22 00:04:50,250 - gcsBot - INFO - Dados macro para 'gold' já estão atualizados.
2025-07-22 00:04:50,251 - gcsBot - INFO - Table 'macro_tnx' created successfully.
2025-07-22 00:04:50,252 - gcsBot - INFO - Dados macro para 'tnx' já estão atualizados.
2025-07-22 00:04:50,253 - gcsBot - INFO - Table 'macro_vix' created successfully.
2025-07-22 00:04:50,254 - gcsBot - INFO - Dados macro para 'vix' já estão atualizados.
2025-07-22 00:04:50,254 - gcsBot - DEBUG - Verificação de dados macro concluída.
2025-07-22 00:04:50,254 - gcsBot - INFO - Iniciando verificação e atualização do sentimento do Twitter...
2025-07-22 00:04:50,265 - gcsBot - INFO - Table 'twitter_sentiment' created successfully.
2025-07-22 00:04:50,278 - gcsBot - INFO - Dataframe inserted into 'twitter_sentiment' successfully.
2025-07-22 00:04:50,278 - gcsBot - DEBUG - Verificação do sentimento do Twitter concluída.
2025-07-22 00:04:50,279 - gcsBot - INFO - Table 'btc_btc_usdt_1m' created successfully.
2025-07-22 00:04:52,214 - gcsBot - INFO - Dados do BTC no banco de dados estão desatualizados. Buscando novos dados da Binance...
2025-07-22 00:04:52,996 - gcsBot - INFO - Dataframe inserted into 'btc_btc_usdt_1m' successfully.
2025-07-22 00:04:53,039 - gcsBot - INFO - SUCESSO: Banco de dados do BTC atualizado com 7 novas velas.
2025-07-22 00:04:53,040 - gcsBot - DEBUG - Padronizando e unificando dados macro do banco de dados...
2025-07-22 00:04:53,067 - gcsBot - DEBUG - Dados macro do banco de dados unificados com sucesso.
2025-07-22 00:04:53,159 - gcsBot - INFO - Iniciando preparação de todas as features e indicadores técnicos...
2025-07-22 00:05:04,092 - gcsBot - DEBUG - Calculando suíte de correlações macro (BTC vs DXY, BTC vs VIX)...
2025-07-22 00:05:04,189 - gcsBot - DEBUG - Cálculo bruto das features concluído.
2025-07-22 00:05:04,190 - gcsBot - INFO - Calculando regimes de mercado (Camada 2: Tendência + Volatilidade)...
2025-07-22 00:05:04,248 - gcsBot - DEBUG - Regimes de mercado calculados.
2025-07-22 00:05:04,424 - gcsBot - INFO - Clustering data into 10 market situations...
2025-07-22 00:05:09,622 - gcsBot - INFO - Clustering complete.
2025-07-22 00:05:09,625 - gcsBot - INFO - Calculando features de interação (Camada 3: Tática Avançada)...
2025-07-22 00:05:09,887 - gcsBot - INFO - Filtrando dados de 2017 em diante e tratando valores ausentes/infinitos...
2025-07-22 00:05:10,051 - gcsBot - INFO - Aplicando shift(1) nas features para evitar lookahead bias...
2025-07-22 00:05:10,404 - gcsBot - DEBUG - Otimizando uso de memória do DataFrame...
2025-07-22 00:05:10,526 - gcsBot - DEBUG - Otimização de memória concluída.
2025-07-22 00:05:10,527 - gcsBot - INFO - Processo de coleta e preparação de dados concluído com sucesso.
2025-07-22 00:05:10,530 - gcsBot - INFO - 
================================================================================
--- 🚀 INICIANDO PROCESSO DE OTIMIZAÇÃO (V9.0) 🚀 ---
================================================================================
2025-07-22 00:05:10,530 - gcsBot - INFO - Training base model...
2025-07-22 00:05:11,147 - gcsBot - INFO - Treinando modelo com 34 features.
2025-07-22 00:05:11,151 - gcsBot - INFO - 
--- Distribuição dos Labels no Treino ---
┏━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃    ┃   Label ┃   Frequência ┃
┣━━━━╋━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃  0 ┃       0 ┃     0.515023 ┃
┣━━━━╋━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃  1 ┃       1 ┃     0.484977 ┃
┗━━━━┻━━━━━━━━━┻━━━━━━━━━━━━━━┛
2025-07-22 00:05:21,364 - gcsBot - INFO - Base model trained.
2025-07-22 00:05:21,411 - gcsBot - INFO - Dados insuficientes para a situação 0.0. Pulando.
2025-07-22 00:05:21,412 - gcsBot - INFO - Dados insuficientes para a situação 5.0. Pulando.
2025-07-22 00:05:21,412 - gcsBot - INFO - Dados insuficientes para a situação 6.0. Pulando.
2025-07-22 00:05:21,413 - gcsBot - INFO - 
--- Plano Mestre de Otimização ---
┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃   Situação a Treinar ┃   Qtd. Velas ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_1.0 ┃        34485 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_2.0 ┃        18707 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_3.0 ┃        16695 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_4.0 ┃        69755 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_7.0 ┃         8711 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_8.0 ┃        53930 ┃
┣━━━━━━━━━━━━━━━━━━━━━━╋━━━━━━━━━━━━━━┫
┃        SITUATION_9.0 ┃        51783 ┃
┗━━━━━━━━━━━━━━━━━━━━━━┻━━━━━━━━━━━━━━┛
2025-07-22 00:05:21,413 - gcsBot - INFO - 
==================== Iniciando otimização para: SITUATION_1.0 (34485 velas) ====================
2025-07-22 00:05:21,415 - gcsBot - ERROR - Um erro crítico encerrou a aplicação: 
Could not find `optuna-integration` for `lightgbm`.
Please run `pip install optuna-integration[lightgbm]`.
Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/optuna/integration/lightgbm.py", line 11, in <module>
    import optuna_integration.lightgbm as lgb
ModuleNotFoundError: No module named 'optuna_integration'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.12/site-packages/optuna/integration/__init__.py", line 132, in _get_module
    return importlib.import_module("." + module_name, self.__name__)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 999, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/usr/local/lib/python3.12/site-packages/optuna/integration/lightgbm.py", line 13, in <module>
    raise ModuleNotFoundError(_INTEGRATION_IMPORT_ERROR_TEMPLATE.format("lightgbm"))
ModuleNotFoundError: 
Could not find `optuna-integration` for `lightgbm`.
Please run `pip install optuna-integration[lightgbm]`.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/app/main.py", line 68, in <module>
    main()
  File "/app/main.py", line 36, in main
    optimizer.run()
  File "/app/src/core/optimizer.py", line 311, in run
    self.run_optimization_for_situation(name, data)
  File "/app/src/core/optimizer.py", line 222, in run_optimization_for_situation
    tuner = optuna.integration.LightGBMTuner(
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/optuna/integration/__init__.py", line 120, in __getattr__
    module = self._get_module(self._class_to_module[name])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/site-packages/optuna/integration/__init__.py", line 134, in _get_module
    raise ModuleNotFoundError(_INTEGRATION_IMPORT_ERROR_TEMPLATE.format(module_name))
ModuleNotFoundError: 
Could not find `optuna-integration` for `lightgbm`.
Please run `pip install optuna-integration[lightgbm]`.
